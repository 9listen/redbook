<template>
  <div class="water">
    <div class="container">
      <div class="content">
        <div class="article-wrapper">
          <!-- imglistsæ‰€æœ‰åˆ—ï¼Œcolumnsæ¯ä¸€åˆ— ,columnåˆ—é‡Œé¢æ¯ä¸ªç¬”è®°å®¹å™¨-->
          <div
            class="article-column"
            v-for="(columns, index) in imglists"
            :key="index"
          >
            <div class="note-con" v-for="(column, i) in columns" :key="i">
              <div class="note">
                <div class="note-img">
                  <img :src="column.cover" alt="" />
                </div>
                <div class="note-info">
                  {{ column.title }}
                </div>
              </div>
              <div class="note-author">
                <div class="user">
                  <div class="user-img">
                    <img :src="column.userinfo.avatar" alt="" />
                  </div>
                  <div class="user-name">{{ column.userinfo.username }}</div>
                </div>
              </div>
            </div>
            <!-- <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div> -->
          </div>
          <!-- <div class="article-column">
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article-column">
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article-column">
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
        </div>
        <div class="article-column">
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
          <div class="note-con">
            <div class="note">
              <div class="note-img">
                <img src="../../static/images/community-2.png" alt="" />
              </div>
              <div class="note-info">
                27å²ç‹¬å±…æ—¶åˆ» | è¯·å‚è§‚æˆ‘å®¶âœ¨å¥¶æ²¹è‰²æ²»æ„ˆå®¢å…
              </div>
            </div>
            <div class="note-author">
              <div class="user">
                <div class="user-img">
                  <img src="../../static/images/avatar.jpg" alt="" />
                </div>
                <div class="user-name">å°æ¾é¼ </div>
              </div>
            </div>
          </div>
        </div> -->
        </div>
      </div>
      <div class="more">æŸ¥çœ‹æ›´å¤š</div>
    </div>
  </div>
</template>

<script>
export default {
  name: 'aWater',
  props: {
    imgs: {
      type: Array,
      default: () => []
    },
    clos: {
      type: Number,
      default: 5
    },
  },
  data () {
    return {
      waterfallHeight: Array(this.clos).fill(0),//æ”¶é›†æ¯åˆ—æ•´ä½“é«˜åº¦[0px,0px...]
      //#region
      imglists: Array(this.clos).fill(0)// [[],[],[],[],[]]  //clos-5åˆ—æ•´ä½“æ•°ç»„ä¿¡æ¯-åŒ…å«æ¯ä»½å›¾ç‰‡ä¿¡æ¯
      //åŸå§‹ç€‘å¸ƒæµæ•°æ®æµ‹è¯•ä»£ç 
      //#region
      // imglists: [
      //   [{
      //     cover: require('../../static/images/co4.png'),
      //     title: 'ç”Ÿæ´»ç‰¹åˆ«æœ‰åŠ²å¤´',
      //     userinfo: {
      //       avatar: require('../../static/images/avatar.jpg'),
      //       username: 'é˜³æ˜¥ç™½é›ª',
      //     },
      //   }]
      // ]
      //#endregion
      //#endregion
    }
  },
  watch: {//ç›‘å¬åˆ—æ•°å˜åŒ–ï¼Œ
    clos (val) {
      this.waterfallHeight = Array(val).fill(0)
      this.imglists = Array(val).fill(0)
    }
  },
  methods: {
    rankimgs () {
      this.imglists = Array(this.clos).fill(0)
      //å›¾ç‰‡300+ç”¨æˆ·ä¿¡æ¯height:28px+padding-bottom:10 + åŠ¨æ€æ–‡æœ¬é«˜åº¦ ï¼ˆ24è¡Œé«˜*nå‡ è¡Œï¼šä¸€è¡Œåœ¨è¿™é‡Œæœ‰11ä¸ªå­—ã€‚æ–‡å­—é•¿åº¦/11ï¼‰
      // ğŸŒˆéå†ä¼ å…¥çš„å›¾ç‰‡ä¿¡æ¯
      for (let i = 0; i < this.imgs.length; i++) {
        //ğŸŒˆå–waterfallHeightæœ€å°é«˜åº¦
        const min = Math.min(...this.waterfallHeight);
        let minIndex = this.waterfallHeight.findIndex(x => x === min);
        // debuggerè°ƒè¯•æ—¶å‡ºç°minIndex=-1çš„æƒ…å†µï¼Œç´¢å¼•ä¸èƒ½ä¸ºè´Ÿ
        // eslint-disable-next-line no-debugger
        // debugger
        if (minIndex === -1) minIndex = 0
        // ğŸŒˆå¦‚æœä¸å­˜åœ¨é«˜åº¦æœ€å°çš„å®¹å™¨
        if (!this.imglists[minIndex])//ï¼Ÿè¿™é‡Œimglistsæ˜¯æ¯ä¸€åˆ—æ•°æ®???
          this.imglists[minIndex] = []
        this.imglists[minIndex].push(JSON.parse(JSON.stringify(this.imgs[i])))
        // è®¡ç®—æ–‡æœ¬é«˜åº¦
        const textHeight = Math.ceil(this.imgs[i].title.length / 11) * 24
        const noteHeight = 300 + 38 + textHeight
        this.waterfallHeight[minIndex] += noteHeight//æœ€å°é«˜åº¦åˆ—åŸå§‹é«˜åº¦+æ–°çš„ç¬”è®°é«˜åº¦
      }
    }
  },
  mounted () {
    this.rankimgs() // åˆ†é…å›¾ç‰‡
    // let arr = Array(3).fill();
    // console.log(arr);

  }
}
</script>

<style lang="less" scoped>
  .container {
    margin-top: 108px;
    border-top: 1px solid #ccc;
    padding-bottom: 50px;
    width: 100%;
    box-sizing: border-box;
    // background-color: #fff;
    .content {
      margin-top: 30px;
      .article-wrapper {
        // æ‰€æœ‰ç¬”è®°ç›’å­
        display: flex;
        justify-content: center;
        align-items: flex-start;
        flex-direction: row;
        // background-color: rgb(240, 179, 179);
        .article-column {
          //ä¸€åˆ—ç¬”è®°
          padding: 0 20px 0 0;
          display: flex;
          justify-content: flex-start;
          align-items: center;
          flex-direction: column;
          //   background-color: rgb(205, 236, 167);
          cursor: pointer;
          //   overflow: hidden;
          .note-con {
            //å•ç‹¬çš„ç¬”è®°
            width: 220px;
            margin: 0 0 20px;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: flex-start;
            // background-color: rgb(213, 164, 164);
            overflow: hidden;
            border-radius: 8px;
            position: relative;
            box-shadow: 0 1px 2px 0 rgb(0 0 0 / 10%);
            .note {
              //å›¾ç‰‡+æè¿°
              width: 100%;
              display: flex;
              flex-direction: column;
              .note-img {
                width: 220px;
                height: 300px;
                overflow: hidden;
                img {
                  width: 220px;
                  height: 300px;
                }
              }
              .note-info {
                padding: 0;
                margin: 10px 15px;
                font-size: 16px;
                font-weight: 400;
                line-height: 24px;
              }
            }
            .note-author {
              // å›¾ç‰‡ä½œè€…
              width: 100%;
              display: flex;
              justify-content: space-between;
              align-items: center;
              padding-bottom: 10px;
              .user {
                display: flex;
                justify-content: flex-start;
                align-items: center;
                .user-img {
                  margin-left: 20px;
                  position: relative;
                  width: 28px;
                  height: 28px;
                  border-radius: 50%;
                  overflow: hidden;
                  img {
                    position: absolute;
                    width: 100%;
                    height: 100%;
                  }
                }
                .user-name {
                  width: 87px;
                  white-space: nowrap;
                  text-overflow: ellipsis;
                  margin-left: 10px;
                }
              }
            }
          }
          // å•ä¸ªç¬”è®°hoverä¸Šå»çš„é˜´å½±
          .note-con:hover::before {
            content: "";
            width: 100%;
            height: 100%;
            border-radius: 8px;
            margin: 0 0 20px;
            background-color: rgba(0, 2, 4, 0.2);
            position: absolute;
            top: 0;
            left: 0;
          }
        }
      }
    }
    .more {
      display: flex;
      justify-content: center;
      align-items: center;
      font-weight: 700;
      line-height: 40px;
      color: #ff2741;
      cursor: pointer;
    }
  }
</style>